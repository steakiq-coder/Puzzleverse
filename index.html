<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>PuzzleVerse ‚Äì AI & Bible Puzzles</title>
<link href="https://fonts.googleapis.com/css2?family=Cinzel+Decorative:wght@400;700&family=Lora:ital,wght@0,400;0,600;1,400&family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
<script src="https://accounts.google.com/gsi/client" async defer></script>
<style>
  :root {
    --gold: #C9A84C;
    --deep: #0D1117;
    --card: #151B27;
    --border: #2A3450;
    --text: #E8DCC8;
    --muted: #7A8299;
    --accent: #4A9EF5;
    --easy: #4CAF50;
    --medium: #FF9800;
    --hard: #F44336;
    --cross: #8B6914;
  }

  * { box-sizing: border-box; margin: 0; padding: 0; }

  body {
    background: var(--deep);
    color: var(--text);
    font-family: 'Lora', serif;
    min-height: 100vh;
    overflow-x: hidden;
  }

  /* Background texture */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(ellipse at 20% 20%, rgba(201,168,76,0.06) 0%, transparent 50%),
      radial-gradient(ellipse at 80% 80%, rgba(74,158,245,0.05) 0%, transparent 50%),
      url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23C9A84C' fill-opacity='0.03'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
    pointer-events: none;
    z-index: 0;
  }

  .app { position: relative; z-index: 1; }

  /* ‚Äî‚Äî‚Äî HEADER ‚Äî‚Äî‚Äî */
  header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 18px 32px;
    background: rgba(13,17,23,0.9);
    backdrop-filter: blur(12px);
    border-bottom: 1px solid var(--border);
    position: sticky;
    top: 0;
    z-index: 100;
  }

  .logo {
    font-family: 'Cinzel Decorative', serif;
    font-size: 1.5rem;
    background: linear-gradient(135deg, var(--gold), #F5D78B, var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    letter-spacing: 2px;
  }

  .logo span { font-size: 0.7rem; display: block; letter-spacing: 4px; opacity: 0.7; margin-top: -4px; }

  .header-right { display: flex; align-items: center; gap: 16px; }

  .user-pill {
    display: flex;
    align-items: center;
    gap: 8px;
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 50px;
    padding: 6px 14px 6px 6px;
    font-size: 0.85rem;
    cursor: pointer;
    transition: border-color 0.2s;
  }
  .user-pill:hover { border-color: var(--gold); }
  .user-pill img { width: 28px; height: 28px; border-radius: 50%; object-fit: cover; }
  .user-pill .avatar-placeholder {
    width: 28px; height: 28px; border-radius: 50%;
    background: linear-gradient(135deg, var(--gold), var(--accent));
    display: flex; align-items: center; justify-content: center;
    font-size: 0.75rem; font-weight: 700; color: var(--deep);
  }

  /* ‚Äî‚Äî‚Äî MAIN NAV TABS ‚Äî‚Äî‚Äî */
  .main-nav {
    display: flex;
    gap: 0;
    padding: 0 32px;
    background: var(--card);
    border-bottom: 1px solid var(--border);
    overflow-x: auto;
  }
  .nav-tab {
    padding: 14px 28px;
    font-family: 'Space Mono', monospace;
    font-size: 0.8rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    cursor: pointer;
    border-bottom: 2px solid transparent;
    white-space: nowrap;
    transition: all 0.2s;
    color: var(--muted);
    background: none;
    border-top: none;
    border-left: none;
    border-right: none;
  }
  .nav-tab:hover { color: var(--text); }
  .nav-tab.active { color: var(--gold); border-bottom-color: var(--gold); }
  .nav-tab.bible-tab.active { color: #8B6914; border-bottom-color: var(--cross); }

  /* ‚Äî‚Äî‚Äî PAGES ‚Äî‚Äî‚Äî */
  .page { display: none; padding: 32px; max-width: 1100px; margin: 0 auto; }
  .page.active { display: block; }

  /* ‚Äî‚Äî‚Äî LOGIN OVERLAY ‚Äî‚Äî‚Äî */
  #loginOverlay {
    position: fixed;
    inset: 0;
    background: rgba(10,14,20,0.97);
    z-index: 1000;
    display: flex;
    align-items: center;
    justify-content: center;
    backdrop-filter: blur(4px);
  }

  .login-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 48px 40px;
    max-width: 420px;
    width: 90%;
    text-align: center;
    position: relative;
    overflow: hidden;
  }
  .login-card::before {
    content: '';
    position: absolute;
    top: -50%;
    left: -50%;
    width: 200%;
    height: 200%;
    background: radial-gradient(ellipse at center, rgba(201,168,76,0.08) 0%, transparent 60%);
    pointer-events: none;
  }

  .login-icon { font-size: 3.5rem; margin-bottom: 16px; }
  .login-card h2 {
    font-family: 'Cinzel Decorative', serif;
    font-size: 1.6rem;
    background: linear-gradient(135deg, var(--gold), #F5D78B);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 8px;
  }
  .login-card p { color: var(--muted); font-size: 0.95rem; margin-bottom: 32px; line-height: 1.6; }

  .google-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 12px;
    width: 100%;
    padding: 14px 24px;
    background: #fff;
    color: #333;
    border: none;
    border-radius: 10px;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s;
    margin-bottom: 16px;
    font-family: 'Lora', serif;
  }
  .google-btn:hover { background: #f0f0f0; transform: translateY(-1px); box-shadow: 0 6px 20px rgba(0,0,0,0.3); }
  .google-btn svg { width: 22px; height: 22px; flex-shrink: 0; }

  .skip-btn {
    background: none;
    border: 1px solid var(--border);
    color: var(--muted);
    width: 100%;
    padding: 12px;
    border-radius: 10px;
    cursor: pointer;
    font-family: 'Lora', serif;
    font-size: 0.9rem;
    transition: all 0.2s;
  }
  .skip-btn:hover { border-color: var(--muted); color: var(--text); }

  /* ‚Äî‚Äî‚Äî HOME PAGE ‚Äî‚Äî‚Äî */
  .hero {
    text-align: center;
    padding: 48px 0 32px;
  }
  .hero h1 {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(1.8rem, 4vw, 3rem);
    background: linear-gradient(135deg, var(--gold), #F5D78B, var(--gold));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    line-height: 1.3;
    margin-bottom: 16px;
  }
  .hero p { color: var(--muted); font-size: 1.1rem; max-width: 550px; margin: 0 auto 40px; }

  .mode-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); gap: 20px; }

  .mode-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 28px;
    cursor: pointer;
    transition: all 0.25s;
    position: relative;
    overflow: hidden;
  }
  .mode-card::before {
    content: '';
    position: absolute;
    inset: 0;
    opacity: 0;
    transition: opacity 0.25s;
    border-radius: 16px;
  }
  .mode-card.ai-card::before { background: radial-gradient(ellipse at top left, rgba(74,158,245,0.12) 0%, transparent 70%); }
  .mode-card.bible-card::before { background: radial-gradient(ellipse at top left, rgba(201,168,76,0.12) 0%, transparent 70%); }
  .mode-card:hover { transform: translateY(-4px); border-color: var(--gold); }
  .mode-card:hover::before { opacity: 1; }

  .card-icon { font-size: 2.5rem; margin-bottom: 14px; }
  .mode-card h3 { font-family: 'Cinzel Decorative', serif; font-size: 1.1rem; margin-bottom: 8px; color: var(--gold); }
  .mode-card p { color: var(--muted); font-size: 0.9rem; line-height: 1.6; }
  .card-badge {
    display: inline-block;
    margin-top: 14px;
    padding: 4px 12px;
    border-radius: 50px;
    font-family: 'Space Mono', monospace;
    font-size: 0.7rem;
    letter-spacing: 1px;
  }
  .badge-ai { background: rgba(74,158,245,0.15); color: var(--accent); border: 1px solid rgba(74,158,245,0.3); }
  .badge-bible { background: rgba(201,168,76,0.15); color: var(--gold); border: 1px solid rgba(201,168,76,0.3); }

  /* ‚Äî‚Äî‚Äî AI PUZZLE PAGE ‚Äî‚Äî‚Äî */
  .ai-panel {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 24px;
  }
  @media (max-width: 720px) { .ai-panel { grid-template-columns: 1fr; } }

  .panel-box {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 24px;
  }
  .panel-box h3 {
    font-family: 'Space Mono', monospace;
    font-size: 0.8rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--accent);
    margin-bottom: 16px;
  }

  .puzzle-type-select {
    display: flex; flex-wrap: wrap; gap: 8px; margin-bottom: 16px;
  }
  .type-btn {
    padding: 6px 14px;
    border: 1px solid var(--border);
    border-radius: 50px;
    background: none;
    color: var(--muted);
    font-size: 0.85rem;
    cursor: pointer;
    transition: all 0.2s;
    font-family: 'Lora', serif;
  }
  .type-btn:hover, .type-btn.active { border-color: var(--accent); color: var(--accent); background: rgba(74,158,245,0.1); }

  .topic-input {
    width: 100%;
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--border);
    border-radius: 10px;
    padding: 12px 16px;
    color: var(--text);
    font-size: 0.95rem;
    font-family: 'Lora', serif;
    margin-bottom: 12px;
    transition: border-color 0.2s;
    resize: vertical;
    min-height: 80px;
  }
  .topic-input:focus { outline: none; border-color: var(--accent); }

  .diff-select { display: flex; gap: 8px; margin-bottom: 16px; }
  .diff-btn {
    flex: 1; padding: 8px; border: 1px solid var(--border);
    border-radius: 8px; background: none; cursor: pointer;
    font-family: 'Space Mono', monospace; font-size: 0.75rem;
    letter-spacing: 1px; transition: all 0.2s; text-transform: uppercase;
  }
  .diff-btn.easy { color: var(--easy); }
  .diff-btn.medium { color: var(--medium); }
  .diff-btn.hard { color: var(--hard); }
  .diff-btn.active.easy { background: rgba(76,175,80,0.15); border-color: var(--easy); }
  .diff-btn.active.medium { background: rgba(255,152,0,0.15); border-color: var(--medium); }
  .diff-btn.active.hard { background: rgba(244,67,54,0.15); border-color: var(--hard); }

  .gen-btn {
    width: 100%;
    padding: 14px;
    background: linear-gradient(135deg, var(--accent), #2C7FD4);
    border: none;
    border-radius: 10px;
    color: #fff;
    font-size: 1rem;
    font-weight: 600;
    cursor: pointer;
    font-family: 'Lora', serif;
    transition: all 0.2s;
    position: relative;
    overflow: hidden;
  }
  .gen-btn:hover { opacity: 0.9; transform: translateY(-1px); }
  .gen-btn:active { transform: translateY(0); }
  .gen-btn.loading { pointer-events: none; }
  .gen-btn .spinner {
    display: none;
    width: 18px; height: 18px;
    border: 2px solid rgba(255,255,255,0.3);
    border-top-color: #fff;
    border-radius: 50%;
    animation: spin 0.8s linear infinite;
    margin: 0 auto;
  }
  .gen-btn.loading .btn-text { display: none; }
  .gen-btn.loading .spinner { display: block; }
  @keyframes spin { to { transform: rotate(360deg); } }

  /* ‚Äî‚Äî‚Äî PUZZLE DISPLAY ‚Äî‚Äî‚Äî */
  .puzzle-display {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 24px;
    min-height: 300px;
  }
  .puzzle-display h3 {
    font-family: 'Space Mono', monospace;
    font-size: 0.8rem;
    letter-spacing: 2px;
    text-transform: uppercase;
    color: var(--gold);
    margin-bottom: 20px;
  }

  .puzzle-empty {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    height: 220px;
    color: var(--muted);
    text-align: center;
    gap: 12px;
  }
  .puzzle-empty .big-icon { font-size: 3rem; opacity: 0.3; }

  /* Word Search Grid */
  .wordsearch-wrap { overflow-x: auto; }
  .wordsearch-grid {
    display: inline-grid;
    gap: 2px;
    background: var(--deep);
    padding: 12px;
    border-radius: 10px;
    user-select: none;
  }
  .ws-cell {
    width: 32px; height: 32px;
    display: flex; align-items: center; justify-content: center;
    font-family: 'Space Mono', monospace;
    font-size: 0.85rem;
    border-radius: 4px;
    cursor: pointer;
    transition: all 0.1s;
    background: rgba(255,255,255,0.03);
    border: 1px solid transparent;
  }
  .ws-cell:hover { background: rgba(74,158,245,0.15); }
  .ws-cell.selected { background: rgba(74,158,245,0.3); border-color: var(--accent); color: #fff; }
  .ws-cell.found { background: rgba(76,175,80,0.25); border-color: var(--easy); color: #fff; }

  .word-list {
    display: flex; flex-wrap: wrap; gap: 8px; margin-top: 16px;
  }
  .word-chip {
    padding: 4px 12px;
    background: rgba(255,255,255,0.05);
    border: 1px solid var(--border);
    border-radius: 50px;
    font-family: 'Space Mono', monospace;
    font-size: 0.75rem;
    letter-spacing: 1px;
    transition: all 0.3s;
  }
  .word-chip.found { background: rgba(76,175,80,0.2); border-color: var(--easy); color: var(--easy); text-decoration: line-through; }

  /* Crossword */
  .crossword-clues { margin-top: 16px; }
  .clue-section h4 { color: var(--gold); font-size: 0.85rem; margin-bottom: 8px; font-family: 'Space Mono', monospace; }
  .clue-item { color: var(--muted); font-size: 0.88rem; margin-bottom: 4px; padding: 4px 0; border-bottom: 1px solid rgba(255,255,255,0.04); }
  .clue-item span { color: var(--text); font-weight: 600; }

  /* Quiz */
  .quiz-question { font-size: 1.05rem; margin-bottom: 20px; line-height: 1.6; }
  .quiz-options { display: flex; flex-direction: column; gap: 8px; }
  .quiz-opt {
    padding: 12px 16px;
    background: rgba(255,255,255,0.04);
    border: 1px solid var(--border);
    border-radius: 10px;
    cursor: pointer;
    transition: all 0.2s;
    text-align: left;
    color: var(--text);
    font-family: 'Lora', serif;
    font-size: 0.95rem;
  }
  .quiz-opt:hover { border-color: var(--accent); background: rgba(74,158,245,0.1); }
  .quiz-opt.correct { background: rgba(76,175,80,0.2); border-color: var(--easy); color: var(--easy); }
  .quiz-opt.wrong { background: rgba(244,67,54,0.15); border-color: var(--hard); color: var(--hard); }
  .quiz-nav { display: flex; gap: 10px; margin-top: 16px; }
  .quiz-nav button {
    flex: 1; padding: 10px; border: 1px solid var(--border); background: none;
    color: var(--text); border-radius: 8px; cursor: pointer; font-family: 'Lora', serif;
    transition: all 0.2s;
  }
  .quiz-nav button:hover { border-color: var(--accent); color: var(--accent); }
  .quiz-score { text-align: center; padding: 20px; color: var(--gold); font-size: 1.1rem; }

  /* ‚Äî‚Äî‚Äî BIBLE PAGE ‚Äî‚Äî‚Äî */
  .bible-header {
    text-align: center;
    padding: 32px 0 24px;
  }
  .bible-header h2 {
    font-family: 'Cinzel Decorative', serif;
    font-size: clamp(1.5rem, 3vw, 2.2rem);
    color: var(--gold);
    margin-bottom: 8px;
  }
  .bible-header p { color: var(--muted); font-style: italic; }

  .bible-verse-bar {
    background: linear-gradient(135deg, rgba(201,168,76,0.08), rgba(139,105,20,0.05));
    border: 1px solid rgba(201,168,76,0.2);
    border-radius: 12px;
    padding: 16px 20px;
    margin-bottom: 28px;
    font-style: italic;
    color: rgba(232,220,200,0.8);
    font-size: 0.9rem;
    text-align: center;
  }
  .bible-verse-bar cite { display: block; margin-top: 6px; color: var(--gold); font-style: normal; font-size: 0.8rem; }

  .level-selector {
    display: flex;
    align-items: center;
    gap: 16px;
    margin-bottom: 24px;
    flex-wrap: wrap;
  }
  .level-selector span { font-family: 'Space Mono', monospace; font-size: 0.8rem; color: var(--muted); letter-spacing: 2px; text-transform: uppercase; }
  .level-btn {
    padding: 8px 20px;
    border: 1px solid var(--border);
    border-radius: 8px;
    background: none;
    cursor: pointer;
    font-family: 'Space Mono', monospace;
    font-size: 0.78rem;
    letter-spacing: 1px;
    transition: all 0.2s;
    text-transform: uppercase;
  }
  .level-btn.lvl1 { color: var(--easy); }
  .level-btn.lvl2 { color: var(--medium); }
  .level-btn.lvl3 { color: var(--hard); }
  .level-btn.lvl4 { color: #E040FB; }
  .level-btn.active.lvl1 { background: rgba(76,175,80,0.15); border-color: var(--easy); }
  .level-btn.active.lvl2 { background: rgba(255,152,0,0.15); border-color: var(--medium); }
  .level-btn.active.lvl3 { background: rgba(244,67,54,0.15); border-color: var(--hard); }
  .level-btn.active.lvl4 { background: rgba(224,64,251,0.15); border-color: #E040FB; }

  .bible-puzzle-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 16px; }

  .bible-puzzle-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 20px;
    cursor: pointer;
    transition: all 0.25s;
    position: relative;
    overflow: hidden;
  }
  .bible-puzzle-card::after {
    content: '';
    position: absolute;
    top: 0; left: 0; right: 0;
    height: 3px;
    background: linear-gradient(90deg, var(--gold), rgba(201,168,76,0.3));
    transform: scaleX(0);
    transform-origin: left;
    transition: transform 0.3s;
  }
  .bible-puzzle-card:hover { transform: translateY(-3px); border-color: rgba(201,168,76,0.4); }
  .bible-puzzle-card:hover::after { transform: scaleX(1); }

  .bp-type { font-family: 'Space Mono', monospace; font-size: 0.7rem; color: var(--gold); letter-spacing: 2px; text-transform: uppercase; margin-bottom: 8px; }
  .bp-title { font-size: 1rem; margin-bottom: 6px; font-weight: 600; }
  .bp-meta { color: var(--muted); font-size: 0.82rem; }
  .bp-stars { margin-top: 10px; color: var(--gold); font-size: 0.9rem; }
  .bp-level-badge {
    position: absolute; top: 14px; right: 14px;
    padding: 3px 9px; border-radius: 50px;
    font-family: 'Space Mono', monospace; font-size: 0.65rem; font-weight: 700; letter-spacing: 1px;
  }
  .badge-easy { background: rgba(76,175,80,0.2); color: var(--easy); border: 1px solid rgba(76,175,80,0.3); }
  .badge-medium { background: rgba(255,152,0,0.2); color: var(--medium); border: 1px solid rgba(255,152,0,0.3); }
  .badge-hard { background: rgba(244,67,54,0.2); color: var(--hard); border: 1px solid rgba(244,67,54,0.3); }
  .badge-expert { background: rgba(224,64,251,0.2); color: #E040FB; border: 1px solid rgba(224,64,251,0.3); }

  /* ‚Äî‚Äî‚Äî ACTIVE PUZZLE MODAL ‚Äî‚Äî‚Äî */
  .puzzle-modal {
    position: fixed;
    inset: 0;
    background: rgba(10,14,20,0.95);
    z-index: 500;
    display: none;
    align-items: center;
    justify-content: center;
    padding: 20px;
    backdrop-filter: blur(6px);
  }
  .puzzle-modal.open { display: flex; }
  .modal-inner {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 32px;
    max-width: 700px;
    width: 100%;
    max-height: 90vh;
    overflow-y: auto;
    position: relative;
  }
  .modal-close {
    position: absolute; top: 16px; right: 16px;
    background: none; border: 1px solid var(--border); color: var(--muted);
    width: 36px; height: 36px; border-radius: 50%; cursor: pointer; font-size: 1rem;
    transition: all 0.2s;
  }
  .modal-close:hover { border-color: var(--hard); color: var(--hard); }

  .modal-title {
    font-family: 'Cinzel Decorative', serif;
    font-size: 1.3rem;
    color: var(--gold);
    margin-bottom: 6px;
  }
  .modal-verse {
    font-style: italic;
    color: var(--muted);
    font-size: 0.9rem;
    margin-bottom: 24px;
    padding-bottom: 16px;
    border-bottom: 1px solid var(--border);
  }

  /* ‚Äî‚Äî‚Äî SCORES PAGE ‚Äî‚Äî‚Äî */
  .scores-list { display: flex; flex-direction: column; gap: 12px; margin-top: 24px; }
  .score-row {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 12px;
    padding: 16px 20px;
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: 12px;
  }
  .score-row:hover { border-color: var(--border); }
  .score-info h4 { font-size: 0.95rem; margin-bottom: 2px; }
  .score-info p { color: var(--muted); font-size: 0.8rem; }
  .score-val { font-family: 'Space Mono', monospace; font-size: 1.1rem; color: var(--gold); }

  /* Utility */
  .flex-row { display: flex; gap: 12px; align-items: center; }
  .mt-16 { margin-top: 16px; }
  .success-msg { color: var(--easy); padding: 12px; background: rgba(76,175,80,0.1); border-radius: 8px; text-align: center; margin-top: 12px; }

  /* Score/Progress Bar */
  .progress-bar-wrap { background: rgba(255,255,255,0.06); border-radius: 50px; height: 8px; margin-top: 8px; }
  .progress-bar { background: linear-gradient(90deg, var(--gold), #F5D78B); height: 100%; border-radius: 50px; transition: width 0.5s; }

  @media (max-width: 600px) {
    header { padding: 14px 16px; }
    .logo { font-size: 1.1rem; }
    .main-nav { padding: 0 8px; }
    .nav-tab { padding: 12px 14px; font-size: 0.7rem; }
    .page { padding: 20px 14px; }
    .ai-panel { grid-template-columns: 1fr; }
  }
</style>
</head>
<body>
<div class="app">

<!-- LOGIN OVERLAY -->
<div id="loginOverlay">
  <div class="login-card">
    <div class="login-icon">‚ú¶</div>
    <h2>PuzzleVerse</h2>
    <p>AI-powered puzzles & sacred Bible word games ‚Äî sign in to save your progress and track your scores.</p>
    <button class="google-btn" onclick="signInWithGoogle()">
      <svg viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
        <path d="M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z" fill="#4285F4"/>
        <path d="M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z" fill="#34A853"/>
        <path d="M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z" fill="#FBBC05"/>
        <path d="M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z" fill="#EA4335"/>
      </svg>
      Sign in with Google
    </button>
    <button class="skip-btn" onclick="continueAsGuest()">Continue as Guest</button>
    <p style="margin-top:16px;font-size:0.75rem;color:var(--muted);">‚ö†Ô∏è To enable real Google Sign-In, add your Google Client ID to the code.</p>
  </div>
</div>

<!-- ACTIVE PUZZLE MODAL -->
<div class="puzzle-modal" id="puzzleModal">
  <div class="modal-inner">
    <button class="modal-close" onclick="closeModal()">‚úï</button>
    <div class="modal-title" id="modalTitle">Puzzle Title</div>
    <div class="modal-verse" id="modalVerse">Verse reference</div>
    <div id="modalContent"></div>
  </div>
</div>

<!-- HEADER -->
<header>
  <div class="logo">PuzzleVerse<span>AI + BIBLE</span></div>
  <div class="header-right">
    <div class="user-pill" onclick="showScores()">
      <div class="avatar-placeholder" id="userAvatar">G</div>
      <span id="userName">Guest</span>
    </div>
  </div>
</header>

<!-- MAIN NAV -->
<div class="main-nav">
  <button class="nav-tab active" onclick="showPage('home', this)">Home</button>
  <button class="nav-tab" onclick="showPage('ai', this)">ü§ñ AI Puzzles</button>
  <button class="nav-tab bible-tab" onclick="showPage('bible', this)">‚úù Bible Puzzles</button>
  <button class="nav-tab" onclick="showPage('scores', this)">üèÜ Scores</button>
</div>

<!-- HOME PAGE -->
<div class="page active" id="home">
  <div class="hero">
    <h1>Challenge Your Mind.<br>Nourish Your Soul.</h1>
    <p>AI-generated puzzles on any topic, plus sacred Bible word games across four levels of mastery.</p>
  </div>
  <div class="mode-grid">
    <div class="mode-card ai-card" onclick="showPage('ai', document.querySelectorAll('.nav-tab')[1])">
      <div class="card-icon">ü§ñ</div>
      <h3>AI Puzzle Studio</h3>
      <p>Generate word searches, crosswords, and quizzes on any topic you choose ‚Äî powered by Claude AI.</p>
      <span class="card-badge badge-ai">POWERED BY AI</span>
    </div>
    <div class="mode-card bible-card" onclick="showPage('bible', document.querySelectorAll('.nav-tab')[2])">
      <div class="card-icon">‚úùÔ∏è</div>
      <h3>Bible Word Challenges</h3>
      <p>Explore Scripture through word puzzles. Four levels from Beginner to Scripture Scholar.</p>
      <span class="card-badge badge-bible">4 LEVELS</span>
    </div>
    <div class="mode-card" onclick="showPage('scores', document.querySelectorAll('.nav-tab')[3])">
      <div class="card-icon">üèÜ</div>
      <h3>Your Progress</h3>
      <p>Track completed puzzles, scores, and your journey through Bible knowledge.</p>
      <span class="card-badge badge-ai" style="background:rgba(201,168,76,0.15);color:var(--gold);border-color:rgba(201,168,76,0.3);">TRACK SCORES</span>
    </div>
  </div>
</div>

<!-- AI PUZZLE PAGE -->
<div class="page" id="ai">
  <div style="margin-bottom:24px;">
    <h2 style="font-family:'Cinzel Decorative',serif;font-size:1.4rem;color:var(--accent);">AI Puzzle Studio</h2>
    <p style="color:var(--muted);margin-top:6px;">Describe any topic and let AI build you a custom puzzle.</p>
  </div>
  <div class="ai-panel">
    <div>
      <div class="panel-box">
        <h3>Puzzle Settings</h3>
        <div style="margin-bottom:12px;">
          <p style="font-size:0.82rem;color:var(--muted);margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;">TYPE</p>
          <div class="puzzle-type-select">
            <button class="type-btn active" data-type="wordsearch" onclick="setType(this)">Word Search</button>
            <button class="type-btn" data-type="quiz" onclick="setType(this)">Quiz</button>
            <button class="type-btn" data-type="crossword" onclick="setType(this)">Crossword</button>
          </div>
        </div>
        <div style="margin-bottom:12px;">
          <p style="font-size:0.82rem;color:var(--muted);margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;">TOPIC OR WORDS</p>
          <textarea class="topic-input" id="topicInput" placeholder="e.g. 'Animals of the African savanna' or 'Space exploration terms'..."></textarea>
        </div>
        <div style="margin-bottom:12px;">
          <p style="font-size:0.82rem;color:var(--muted);margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;text-transform:uppercase;">DIFFICULTY</p>
          <div class="diff-select">
            <button class="diff-btn easy active" onclick="setDiff(this,'easy')">Easy</button>
            <button class="diff-btn medium" onclick="setDiff(this,'medium')">Medium</button>
            <button class="diff-btn hard" onclick="setDiff(this,'hard')">Hard</button>
          </div>
        </div>
        <button class="gen-btn" id="genBtn" onclick="generateAIPuzzle()">
          <span class="btn-text">‚ú¶ Generate Puzzle</span>
          <div class="spinner"></div>
        </button>
        <div id="aiMsg"></div>
      </div>
    </div>
    <div class="puzzle-display" id="puzzleOutput">
      <h3>Puzzle Output</h3>
      <div class="puzzle-empty">
        <div class="big-icon">‚ú¶</div>
        <p>Your puzzle will appear here after generation</p>
      </div>
    </div>
  </div>
</div>

<!-- BIBLE PAGE -->
<div class="page" id="bible">
  <div class="bible-header">
    <h2>Bible Word Challenges</h2>
    <p>"Thy word is a lamp unto my feet, and a light unto my path." ‚Äî Psalm 119:105</p>
  </div>
  <div class="bible-verse-bar">
    <em id="dailyVerse">For God so loved the world, that he gave his only begotten Son, that whosoever believeth in him should not perish, but have everlasting life.</em>
    <cite id="dailyRef">‚Äî John 3:16</cite>
  </div>
  <div class="level-selector">
    <span>Level:</span>
    <button class="level-btn lvl1 active" onclick="filterBible(1, this)">‚≠ê Beginner</button>
    <button class="level-btn lvl2" onclick="filterBible(2, this)">‚≠ê‚≠ê Faithful</button>
    <button class="level-btn lvl3" onclick="filterBible(3, this)">‚≠ê‚≠ê‚≠ê Disciple</button>
    <button class="level-btn lvl4" onclick="filterBible(4, this)">‚≠ê‚≠ê‚≠ê‚≠ê Scholar</button>
    <button class="level-btn" style="color:var(--muted);" onclick="filterBible(0, this)">All</button>
  </div>
  <div class="bible-puzzle-grid" id="bibleGrid"></div>
</div>

<!-- SCORES PAGE -->
<div class="page" id="scores">
  <h2 style="font-family:'Cinzel Decorative',serif;font-size:1.4rem;color:var(--gold);margin-bottom:8px;">Your Progress</h2>
  <p style="color:var(--muted);">Sign in with Google to save scores across sessions.</p>
  <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(160px,1fr));gap:16px;margin:24px 0;">
    <div class="panel-box" style="text-align:center;">
      <p style="color:var(--muted);font-size:0.8rem;margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;">PUZZLES DONE</p>
      <p style="font-size:2rem;font-family:'Space Mono',monospace;color:var(--gold);" id="statDone">0</p>
    </div>
    <div class="panel-box" style="text-align:center;">
      <p style="color:var(--muted);font-size:0.8rem;margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;">BIBLE PUZZLES</p>
      <p style="font-size:2rem;font-family:'Space Mono',monospace;color:var(--gold);" id="statBible">0</p>
    </div>
    <div class="panel-box" style="text-align:center;">
      <p style="color:var(--muted);font-size:0.8rem;margin-bottom:8px;font-family:'Space Mono',monospace;letter-spacing:1px;">BEST SCORE</p>
      <p style="font-size:2rem;font-family:'Space Mono',monospace;color:var(--gold);" id="statBest">‚Äî</p>
    </div>
  </div>
  <div class="scores-list" id="scoresList">
    <p style="color:var(--muted);font-style:italic;">No puzzles completed yet. Start playing!</p>
  </div>
</div>

</div><!-- end .app -->

<script>
// ‚Äî‚Äî‚Äî STATE ‚Äî‚Äî‚Äî
let state = {
  user: null,
  puzzleType: 'wordsearch',
  difficulty: 'easy',
  scores: JSON.parse(localStorage.getItem('pv_scores') || '[]'),
  bibleLevel: 1
};

// ‚Äî‚Äî‚Äî GOOGLE SIGN IN ‚Äî‚Äî‚Äî
function signInWithGoogle() {
  // In production, use your real Google Client ID:
  // google.accounts.id.initialize({ client_id: 'YOUR_CLIENT_ID', callback: handleCredentialResponse });
  // google.accounts.id.prompt();
  
  // Demo mock sign-in:
  const mockUser = { name: 'Player One', email: 'player@gmail.com', initials: 'P' };
  setUser(mockUser);
  document.getElementById('loginOverlay').style.display = 'none';
  showToast('Welcome back, ' + mockUser.name + '! üéâ');
}

function continueAsGuest() {
  setUser({ name: 'Guest', email: null, initials: 'G' });
  document.getElementById('loginOverlay').style.display = 'none';
}

function setUser(user) {
  state.user = user;
  document.getElementById('userName').textContent = user.name;
  document.getElementById('userAvatar').textContent = user.initials || user.name[0];
}

// Handle real Google credential response
function handleCredentialResponse(response) {
  const base64 = response.credential.split('.')[1];
  const payload = JSON.parse(atob(base64));
  setUser({ name: payload.name, email: payload.email, initials: payload.given_name[0] });
  document.getElementById('loginOverlay').style.display = 'none';
}

// ‚Äî‚Äî‚Äî NAVIGATION ‚Äî‚Äî‚Äî
function showPage(id, tabEl) {
  document.querySelectorAll('.page').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.nav-tab').forEach(t => t.classList.remove('active'));
  document.getElementById(id).classList.add('active');
  if (tabEl) tabEl.classList.add('active');
  if (id === 'scores') updateScoresPage();
  if (id === 'bible') renderBibleGrid(state.bibleLevel);
}

// ‚Äî‚Äî‚Äî AI PUZZLE SETTINGS ‚Äî‚Äî‚Äî
function setType(btn) {
  document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  state.puzzleType = btn.dataset.type;
}

function setDiff(btn, diff) {
  document.querySelectorAll('.diff-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  state.difficulty = diff;
}

// ‚Äî‚Äî‚Äî AI GENERATION ‚Äî‚Äî‚Äî
async function generateAIPuzzle() {
  const topic = document.getElementById('topicInput').value.trim();
  if (!topic) { showMsg('aiMsg', 'Please enter a topic or some words.', 'error'); return; }
  
  const btn = document.getElementById('genBtn');
  btn.classList.add('loading');
  
  const systemPrompt = `You are a puzzle generator. Generate a ${state.puzzleType} puzzle about "${topic}" at ${state.difficulty} difficulty. 
  
  For WORD SEARCH: respond with JSON: {"type":"wordsearch","words":["WORD1","WORD2",...8-12 words related to topic in caps], "title":"Puzzle Title"}
  For QUIZ: respond with JSON: {"type":"quiz","title":"Quiz Title","questions":[{"q":"question text","options":["A","B","C","D"],"answer":0},...5 questions]}
  For CROSSWORD: respond with JSON: {"type":"crossword","title":"Title","clues":{"across":[{"num":1,"clue":"hint","answer":"WORD"},...4-5],"down":[{"num":1,"clue":"hint","answer":"WORD"},...3-4]}}
  
  Respond ONLY with valid JSON, no extra text.`;

  try {
    const response = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        messages: [{ role: 'user', content: systemPrompt }]
      })
    });
    const data = await response.json();
    const text = data.content[0].text.replace(/```json\n?|```/g, '').trim();
    const puzzle = JSON.parse(text);
    renderAIPuzzle(puzzle);
    recordScore('AI: ' + puzzle.title, state.difficulty);
  } catch(e) {
    // fallback demo puzzle
    renderAIPuzzle(getDemoPuzzle(state.puzzleType, topic));
  }
  
  btn.classList.remove('loading');
}

function getDemoPuzzle(type, topic) {
  if (type === 'wordsearch') return { type:'wordsearch', title: topic + ' Word Search', words: ['EXPLORE','DISCOVER','WONDER','JOURNEY','SEARCH','PUZZLE','LEARN','THINK','CREATE','SOLVE'] };
  if (type === 'quiz') return { type:'quiz', title: topic + ' Quiz', questions: [
    {q:'Which of the following best describes this topic?', options:[topic+' A', topic+' B', topic+' C', topic+' D'], answer:0},
    {q:'What is the most important aspect?', options:['Knowledge','Wisdom','Skill','Curiosity'], answer:3},
    {q:'Choose the correct definition:', options:['Option A','Option B','Option C','Option D'], answer:1},
    {q:'Which example fits best?', options:['Example 1','Example 2','Example 3','Example 4'], answer:2},
    {q:'Final challenge question about this topic:', options:['First','Second','Third','Fourth'], answer:0}
  ]};
  return { type:'crossword', title: topic + ' Crossword', clues:{ across:[{num:1,clue:'To search and find',answer:'EXPLORE'},{num:2,clue:'A test of knowledge',answer:'QUIZ'},{num:3,clue:'Mental challenge',answer:'PUZZLE'}], down:[{num:1,clue:'To gain knowledge',answer:'LEARN'},{num:2,clue:'To solve a problem',answer:'THINK'}] }};
}

function renderAIPuzzle(puzzle) {
  const out = document.getElementById('puzzleOutput');
  if (puzzle.type === 'wordsearch') {
    out.innerHTML = `<h3>${puzzle.title}</h3>` + buildWordSearch(puzzle.words);
  } else if (puzzle.type === 'quiz') {
    out.innerHTML = `<h3>${puzzle.title}</h3>` + buildQuiz(puzzle.questions);
  } else {
    out.innerHTML = `<h3>${puzzle.title}</h3>` + buildCrosswordInfo(puzzle.clues);
  }
}

// ‚Äî‚Äî‚Äî WORD SEARCH ‚Äî‚Äî‚Äî
function buildWordSearch(words) {
  const size = 12;
  let grid = Array.from({length:size},()=>Array(size).fill(''));
  const dirs = [[0,1],[1,0],[0,-1],[-1,0],[1,1],[1,-1],[-1,1],[-1,-1]];
  
  words.forEach(word => {
    let placed = false, attempts = 0;
    while (!placed && attempts < 100) {
      attempts++;
      const dir = dirs[Math.floor(Math.random()*dirs.length)];
      const row = Math.floor(Math.random()*size);
      const col = Math.floor(Math.random()*size);
      let fits = true;
      for (let i = 0; i < word.length; i++) {
        const r = row+dir[0]*i, c = col+dir[1]*i;
        if (r<0||r>=size||c<0||c>=size||(grid[r][c]&&grid[r][c]!==word[i])) { fits=false; break; }
      }
      if (fits) {
        for (let i=0;i<word.length;i++) grid[row+dir[0]*i][col+dir[1]*i] = word[i];
        placed = true;
      }
    }
  });
  
  const alpha = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';
  for (let r=0;r<size;r++) for (let c=0;c<size;c++) if (!grid[r][c]) grid[r][c]=alpha[Math.floor(Math.random()*26)];
  
  let html = `<div class="wordsearch-wrap"><div class="wordsearch-grid" id="wsGrid" style="grid-template-columns:repeat(${size},32px)">`;
  for (let r=0;r<size;r++) for (let c=0;c<size;c++) {
    html += `<div class="ws-cell" data-r="${r}" data-c="${c}" onclick="selectCell(this)">${grid[r][c]}</div>`;
  }
  html += '</div></div>';
  html += '<div class="word-list" id="wsList">' + words.map(w=>`<span class="word-chip" id="wc_${w}">${w}</span>`).join('') + '</div>';
  html += '<p style="color:var(--muted);font-size:0.8rem;margin-top:12px;">Click cells to select letters and find the hidden words!</p>';
  
  // Store solution
  window._wsGrid = grid;
  window._wsWords = words;
  window._wsSelected = [];
  return html;
}

let wsSelected = [];
function selectCell(el) {
  el.classList.toggle('selected');
  const key = el.dataset.r+','+el.dataset.c;
  const idx = wsSelected.indexOf(key);
  if (idx > -1) wsSelected.splice(idx,1);
  else wsSelected.push(key);
  
  // Check if selection spells a word
  const letters = wsSelected.map(k => {
    const [r,c] = k.split(',');
    return window._wsGrid[r][c];
  }).join('');
  
  const found = window._wsWords && window._wsWords.find(w => w === letters || w === letters.split('').reverse().join(''));
  if (found) {
    wsSelected.forEach(k => {
      const [r,c]=k.split(',');
      const cell = document.querySelector(`[data-r="${r}"][data-c="${c}"]`);
      if (cell) { cell.classList.remove('selected'); cell.classList.add('found'); }
    });
    const chip = document.getElementById('wc_'+found);
    if (chip) chip.classList.add('found');
    wsSelected = [];
    showToast('Found: ' + found + '! üéâ');
  }
}

// ‚Äî‚Äî‚Äî QUIZ ‚Äî‚Äî‚Äî
let quizState = { idx:0, score:0, answered:false };
function buildQuiz(questions) {
  window._quizQs = questions;
  quizState = { idx:0, score:0, answered:false };
  return renderQuestion(0);
}

function renderQuestion(idx) {
  const q = window._quizQs[idx];
  if (!q) return `<div class="quiz-score">üéâ Quiz Complete! Score: ${quizState.score}/${window._quizQs.length}</div>`;
  quizState.answered = false;
  return `<div class="quiz-question"><span style="color:var(--muted);font-size:0.8rem;">Q${idx+1}/${window._quizQs.length}</span><br/>${q.q}</div>
  <div class="quiz-options">${q.options.map((o,i)=>`<button class="quiz-opt" onclick="answerQuiz(${i})">${o}</button>`).join('')}</div>
  <div class="quiz-nav"><button onclick="prevQ()">‚Üê Prev</button><button onclick="nextQ()">Next ‚Üí</button></div>`;
}

function answerQuiz(i) {
  if (quizState.answered) return;
  quizState.answered = true;
  const q = window._quizQs[quizState.idx];
  const opts = document.querySelectorAll('.quiz-opt');
  opts[i].classList.add(i===q.answer?'correct':'wrong');
  if (i===q.answer) { quizState.score++; showToast('Correct! ‚úì'); }
  else { opts[q.answer].classList.add('correct'); showToast('Not quite. The answer was: '+q.options[q.answer]); }
}

function nextQ() {
  quizState.idx = Math.min(quizState.idx+1, (window._quizQs||[]).length);
  const out = document.getElementById('puzzleOutput');
  const h3 = out.querySelector('h3').outerHTML;
  out.innerHTML = h3 + renderQuestion(quizState.idx);
}
function prevQ() {
  quizState.idx = Math.max(0, quizState.idx-1);
  const out = document.getElementById('puzzleOutput');
  const h3 = out.querySelector('h3').outerHTML;
  out.innerHTML = h3 + renderQuestion(quizState.idx);
}

// ‚Äî‚Äî‚Äî CROSSWORD INFO ‚Äî‚Äî‚Äî
function buildCrosswordInfo(clues) {
  let html = '<div class="crossword-clues">';
  html += '<div class="clue-section" style="margin-bottom:16px;"><h4>‚Üí ACROSS</h4>';
  clues.across.forEach(c => { html += `<div class="clue-item"><span>${c.num}.</span> ${c.clue} (${c.answer.length})</div>`; });
  html += '</div><div class="clue-section"><h4>‚Üì DOWN</h4>';
  clues.down.forEach(c => { html += `<div class="clue-item"><span>${c.num}.</span> ${c.clue} (${c.answer.length})</div>`; });
  html += '</div></div><p style="color:var(--muted);font-size:0.8rem;margin-top:16px;">üìù Print this page or use the clues to fill in the answers on paper or another tool.</p>';
  return html;
}

// ‚Äî‚Äî‚Äî BIBLE DATA ‚Äî‚Äî‚Äî
const BIBLE_PUZZLES = [
  // Level 1 - Beginner
  { id:'b1', title:'Names of God', type:'wordsearch', level:1, ref:'Isaiah 9:6', desc:'Find names and titles of God hidden in the grid', words:['JEHOVAH','LORD','FATHER','HOLY','SAVIOR','KING','SHEPHERD','CREATOR','ALPHA','OMEGA'] },
  { id:'b2', title:'Books of Moses', type:'wordsearch', level:1, ref:'Deuteronomy 31:24', desc:'Find the five books of Moses', words:['GENESIS','EXODUS','LEVITICUS','NUMBERS','DEUTERONOMY'] },
  { id:'b3', title:'The Nativity', type:'quiz', level:1, ref:'Luke 2:1-20', desc:'Quiz on the birth of Jesus Christ', questions:[
    {q:'Where was Jesus born?',options:['Jerusalem','Nazareth','Bethlehem','Jericho'],answer:2},
    {q:'What did the angel tell the shepherds?',options:['Fear not','Go away','Come back','Be silent'],answer:0},
    {q:'What did the wise men bring?',options:['Gold silver bronze','Gold frankincense myrrh','Food water shelter','Books scrolls pens'],answer:1},
    {q:'Who was the mother of Jesus?',options:['Elizabeth','Martha','Mary','Sarah'],answer:2},
    {q:'What was Jesus laid in?',options:['A bed','A basket','A manger','A tent'],answer:2}
  ]},
  
  // Level 2 - Faithful
  { id:'b4', title:'Fruits of the Spirit', type:'wordsearch', level:2, ref:'Galatians 5:22-23', desc:'Find all nine fruits of the Spirit', words:['LOVE','JOY','PEACE','PATIENCE','KINDNESS','GOODNESS','FAITHFULNESS','GENTLENESS','SELFCONTROL'] },
  { id:'b5', title:'The Apostles', type:'wordsearch', level:2, ref:'Matthew 10:2-4', desc:'Find the names of the twelve apostles', words:['PETER','ANDREW','JAMES','JOHN','PHILIP','BARTHOLOMEW','MATTHEW','THOMAS','SIMON','JUDAS'] },
  { id:'b6', title:'Parables of Jesus', type:'quiz', level:2, ref:'Matthew 13', desc:'Test your knowledge of Jesus\' parables', questions:[
    {q:'In the Parable of the Prodigal Son, what did the father give his returning son?',options:['A scroll','A robe and ring','A donkey','A field'],answer:1},
    {q:'In the Parable of the Sower, what does the seed represent?',options:['Money','People','The Word of God','Bread'],answer:2},
    {q:'How many talents did the faithful servant double?',options:['One','Two','Five','Ten'],answer:2},
    {q:'What is the Kingdom of Heaven compared to in Matthew 13?',options:['A mountain','A mustard seed','A great river','A city'],answer:1},
    {q:'In the Good Samaritan, who helped the injured man first?',options:['A Priest','A Levite','A Roman Soldier','The Samaritan'],answer:3}
  ]},
  
  // Level 3 - Disciple
  { id:'b7', title:'Prophets of Israel', type:'wordsearch', level:3, ref:'Hebrews 1:1', desc:'Find the major and minor prophets', words:['ISAIAH','JEREMIAH','EZEKIEL','DANIEL','HOSEA','AMOS','MICAH','NAHUM','HABAKKUK','ZECHARIAH'] },
  { id:'b8', title:'The Psalms', type:'quiz', level:3, ref:'Psalms 23:1', desc:'Deep dive into the Psalms of David', questions:[
    {q:'Who wrote most of the Psalms?',options:['Moses','Solomon','David','Asaph'],answer:2},
    {q:'Psalm 23 begins "The Lord is my ___"',options:['Light','Rock','Shepherd','Fortress'],answer:2},
    {q:'Which Psalm is the longest chapter in the Bible?',options:['Psalm 100','Psalm 119','Psalm 150','Psalm 91'],answer:1},
    {q:'How many Psalms are in the book?',options:['100','130','150','175'],answer:2},
    {q:'"Create in me a clean heart, O God" is from which Psalm?',options:['Psalm 22','Psalm 51','Psalm 119','Psalm 139'],answer:1}
  ]},
  { id:'b9', title:'Kings of Israel', type:'crossword', level:3, ref:'1 Samuel 8:5', desc:'Crossword on the kings of the united and divided kingdom', clues:{ across:[{num:1,clue:'First king of Israel',answer:'SAUL'},{num:2,clue:'Wise king, son of David',answer:'SOLOMON'},{num:3,clue:'Killed Goliath',answer:'DAVID'}], down:[{num:1,clue:'King known for wisdom',answer:'SOLOMON'},{num:4,clue:'Northern kingdom rebel king',answer:'JEROBOAM'}]}},
  
  // Level 4 - Scholar
  { id:'b10', title:'Epistles of Paul', type:'wordsearch', level:4, ref:'Romans 1:1', desc:'Find the letters written by Paul the Apostle', words:['ROMANS','CORINTHIANS','GALATIANS','EPHESIANS','PHILIPPIANS','COLOSSIANS','THESSALONIANS','TIMOTHY','TITUS','PHILEMON'] },
  { id:'b11', title:'Revelation Symbols', type:'quiz', level:4, ref:'Revelation 1:3', desc:'Expert knowledge of the Book of Revelation', questions:[
    {q:'How many seals are broken in Revelation?',options:['5','6','7','12'],answer:2},
    {q:'What is the number of the beast?',options:['666','777','888','999'],answer:0},
    {q:'What does the white horse in Revelation symbolize?',options:['War','Famine','Death','Conquest/Pestilence'],answer:3},
    {q:'How many churches are addressed in Revelation chapters 2-3?',options:['5','7','10','12'],answer:1},
    {q:'What is the New Jerusalem described as coming down from?',options:['The Earth','The Sea','Heaven','The Mountains'],answer:2}
  ]},
  { id:'b12', title:'Hebrew Covenant Words', type:'crossword', level:4, ref:'Genesis 15:18', desc:'Advanced crossword on covenant theology', clues:{ across:[{num:1,clue:'Hebrew word for covenant',answer:'BERIT'},{num:2,clue:'Promised land patriarch',answer:'ABRAHAM'},{num:3,clue:'Ark builder',answer:'NOAH'}], down:[{num:1,clue:'Blood of the covenant',answer:'BLOOD'},{num:5,clue:'Covenant sign in sky',answer:'RAINBOW'}]}}
];

const DAILY_VERSES = [
  { text:'For God so loved the world, that he gave his only begotten Son...', ref:'John 3:16' },
  { text:'I can do all things through Christ which strengtheneth me.', ref:'Philippians 4:13' },
  { text:'Trust in the Lord with all thine heart; and lean not unto thine own understanding.', ref:'Proverbs 3:5' },
  { text:'Be strong and courageous. Do not be afraid; do not be discouraged.', ref:'Joshua 1:9' }
];

function renderBibleGrid(level) {
  const grid = document.getElementById('bibleGrid');
  const puzzles = level === 0 ? BIBLE_PUZZLES : BIBLE_PUZZLES.filter(p => p.level === level);
  const levelNames = ['','Beginner','Faithful','Disciple','Scholar'];
  const levelColors = ['','easy','medium','hard','expert'];
  
  grid.innerHTML = puzzles.map(p => `
    <div class="bible-puzzle-card" onclick="openBiblePuzzle('${p.id}')">
      <span class="bp-level-badge badge-${levelColors[p.level]}">${levelNames[p.level]}</span>
      <div class="bp-type">${p.type.toUpperCase()}</div>
      <div class="bp-title">${p.title}</div>
      <div class="bp-meta">${p.desc}</div>
      <div class="bp-stars">${'‚≠ê'.repeat(p.level)}</div>
      <div class="bp-meta" style="margin-top:6px;font-style:italic;color:var(--gold)">${p.ref}</div>
    </div>
  `).join('');
}

function filterBible(level, btn) {
  document.querySelectorAll('.level-btn').forEach(b => b.classList.remove('active'));
  btn.classList.add('active');
  state.bibleLevel = level;
  renderBibleGrid(level);
}

function openBiblePuzzle(id) {
  const p = BIBLE_PUZZLES.find(b => b.id === id);
  if (!p) return;
  
  document.getElementById('modalTitle').textContent = p.title;
  document.getElementById('modalVerse').textContent = p.ref + ' ‚Äî ' + p.desc;
  
  let content = '';
  if (p.type === 'wordsearch') content = buildWordSearch(p.words);
  else if (p.type === 'quiz') { window._quizQs = p.questions; quizState={idx:0,score:0,answered:false}; content = renderQuestion(0); }
  else content = buildCrosswordInfo(p.clues);
  
  document.getElementById('modalContent').innerHTML = content;
  document.getElementById('puzzleModal').classList.add('open');
  recordScore('Bible: ' + p.title, ['','Beginner','Faithful','Disciple','Scholar'][p.level], true);
}

function closeModal() {
  document.getElementById('puzzleModal').classList.remove('open');
}

// ‚Äî‚Äî‚Äî SCORES ‚Äî‚Äî‚Äî
function recordScore(name, level, isBible = false) {
  const entry = { name, level, time: new Date().toLocaleDateString(), isBible };
  state.scores.unshift(entry);
  if (state.scores.length > 50) state.scores.pop();
  localStorage.setItem('pv_scores', JSON.stringify(state.scores));
  updateStatsBar();
}

function updateStatsBar() {
  const statDone = document.getElementById('statDone');
  const statBible = document.getElementById('statBible');
  if (statDone) statDone.textContent = state.scores.length;
  if (statBible) statBible.textContent = state.scores.filter(s => s.isBible).length;
  const statBest = document.getElementById('statBest');
  if (statBest) statBest.textContent = state.scores.length > 0 ? state.scores.length * 10 : '‚Äî';
}

function updateScoresPage() {
  updateStatsBar();
  const list = document.getElementById('scoresList');
  if (!state.scores.length) { list.innerHTML = '<p style="color:var(--muted);font-style:italic;">No puzzles completed yet. Start playing!</p>'; return; }
  list.innerHTML = state.scores.slice(0,20).map(s => `
    <div class="score-row">
      <div class="score-info">
        <h4>${s.name}</h4>
        <p>${s.level} ¬∑ ${s.time}</p>
      </div>
      <div class="score-val">+10</div>
    </div>
  `).join('');
}

// ‚Äî‚Äî‚Äî TOAST ‚Äî‚Äî‚Äî
function showToast(msg) {
  let t = document.getElementById('toast');
  if (!t) {
    t = document.createElement('div');
    t.id = 'toast';
    t.style.cssText = 'position:fixed;bottom:24px;left:50%;transform:translateX(-50%);background:var(--card);border:1px solid var(--gold);color:var(--text);padding:12px 24px;border-radius:50px;font-size:0.9rem;z-index:9999;transition:opacity 0.3s;pointer-events:none;';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  t.style.opacity = '1';
  clearTimeout(t._timer);
  t._timer = setTimeout(() => { t.style.opacity = '0'; }, 2500);
}

function showMsg(id, msg, type) {
  const el = document.getElementById(id);
  if (!el) return;
  el.innerHTML = `<p style="color:${type==='error'?'var(--hard)':'var(--easy)'};font-size:0.85rem;margin-top:8px;">${msg}</p>`;
  setTimeout(() => el.innerHTML='', 3000);
}

function showScores() { showPage('scores', document.querySelectorAll('.nav-tab')[3]); }

// ‚Äî‚Äî‚Äî INIT ‚Äî‚Äî‚Äî
(function init() {
  // Set random daily verse
  const v = DAILY_VERSES[Math.floor(Math.random()*DAILY_VERSES.length)];
  const dv = document.getElementById('dailyVerse');
  const dr = document.getElementById('dailyRef');
  if (dv) dv.textContent = v.text;
  if (dr) dr.textContent = '‚Äî ' + v.ref;
  renderBibleGrid(1);
  updateStatsBar();
})();
</script>
</body>
</html>
